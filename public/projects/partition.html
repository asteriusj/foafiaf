<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
     <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
     
    <title>T-Map Project Partition Diagram</title>
    <meta name="description" content="A visualisation of projects">
    
    <link type="text/css" rel="stylesheet" href="/css/style.css"/>
    <script type="text/javascript" src="/dist/d3.js"></script>
    <script type="text/javascript" src="/dist/d3.layout.js"></script>
    <script type="text/javascript" src="/js/iw.js"></script>
	  <script type="text/javascript" src="/js/utils.js"></script>
	  <script type="text/javascript" src="partition.js"></script>
	   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
	   <script src="/js/smtp.js"></script>
     <script src="/js/spin.min.js"></script>
    
<style type="text/css">
    
    /*view-source:http://mbostock.github.io/d3/talk/20111018/partition.html*/

.chart {
  display: block;
  margin: auto;
  margin-top: 60px;
  font-size: 11px;
}

rect {
  stroke: #eee;
  fill: #aaa;
  fill-opacity: .8;
}

rect.parent {
  cursor: pointer;
  fill: steelblue;
}

text {
  pointer-events: none;
}

</style>
    
</head>
<body>
<script type="text/javascript">
let datalink = null;
//const dataURL = datalink || "../things/jsonld/combinedJSONLD.jsonld";
const dataURL = datalink || "https://s3.amazonaws.com/transformrockford/combinedJSONLD.jsonld";
function getTheData(dataURL, cb) {
    console.log('getTheData') //  retrieve graph data from jsonld file
    
    try {
    //var dataPromise = $.Deferred();
    console.log('dataURL -> ', dataURL)
    
    $.getJSON(dataURL, function(data) {
        console.log('getJSON')
        //console.log(data)
        let treeData = data
        //console.log('treeData',treeData)
        
        if (cb) cb(null, treeData )

    });
    } catch(e) {
      console.error('e',e)
    }
}  
</script>
<script type="text/javascript">
function PartitionDiagram1() {
    console.log('PartitionDiagram1')
    
    var result =  getTheData(dataURL, function(err, json) {
        let data = json;
        console.log('PartitionDiagram1 data',data)
        dataReceived(data, function(wheelJS) {
            console.log('PartitionDiagram1 wheelJS', wheelJS)
            
            // let spliced = { "name": "Top 25 by 2025", "children": wheelJS }
            // console.log('sliced', spliced)
            // wheelJS = spliced;
            
            /*global whenready*/
            whenready();    
      });
    });
}
PartitionDiagram1()
  
</script>

<main id="mainArea">
  <h1>Project Partition Diagram</h1>
    
  <div id="partition1">


    <div id="body">
      <div id="footer">
        Project 
        <div class="hint">click or option-click to descend or ascend</div>
      </div>
    </div>
   
    
          
  </div>
</main>

<script type="text/javascript">
  const target = document.getElementById('mainArea')
  console.log('target',target)
  var spinner = new Spinner().spin(target);
  console.log('start spinner',spinner)
</script>

</body>
</html>
